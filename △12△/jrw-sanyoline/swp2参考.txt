

2008年8月17日 (日) ATS-SW/P2プラグイン 
| 固定リンク | コメント (0) | トラックバック (0) 

 

 
ATS車上子の位置の扱い




実車では，ATS車上子は列車先頭（連結器基準）よりも後方に設置されていますが，ATS-SW/P2プラグインでは，列車先頭がTrack.Beaconによる地上子を通過したときに情報を取得します（.Beaconの仕様）。従って，特に出発信号機に対する地上子を実際の位置にそのまま置いた場合，発車時に保持しているATS-P停止パターンによる常用ブレーキが動作するなど，問題が生じる場合があります。

問題が発生する箇所や，この車上子のオフセット距離が気になる場合は，.BeaconにNullストラクチャを割り当てて，地上子のストラクチャは.FreeObjで設置します。

なお，標準的な車両では，ATS-SW車上子は先頭から約5m，ATS-P車上子は先頭から約15mの位置にあります。

（参考）
321ats 



2007年9月16日 (日) ATS-SW/P2プラグイン 
| 固定リンク | コメント (0) | トラックバック (0) 

 

 
第六　ＡＴＳ−Ｐ （2006.12.3仕様変更）




ATS-Pは，停止信号までの距離を地上子から受信し，停止信号を冒進しない減速パターン（停止パターン）を車上で演算し生成する。
列車の速度が停止パターンを超えた場合には常用最大制動が掛かる。
また，信号機の手前30mには即時停止地上子があり，閉塞信号機が停止現示の場合には10km/h以上で通過した場合に，場内・出発信号機が停止現示のときには速度にかかわらず非常制動を掛ける。
地上子の種別は，パターン更新地上子が 3，即時停止地上子が 4(場内・出発)と5（閉塞）である。パターン更新地上子の第4引数には，当該地点から地上子構文の対応する閉塞までの間の閉塞数を数字で入れる。この数字は1,2,3,...,9の順として，途中を省略しても構わないが，最後は必ず9とする。即時停止地上子では，第4引数は使用しない。

　なお，ATS-Pは，パターン更新地上子から得た信号現示情報に停止信号現示がなくても，開通の保障されている最も奥の地点を停止予定位置として停止パターンを生成する。従って，地上子設置地点から3閉塞先までの信号現示を地上子でプラグインに与えた場合，3閉塞先がその現示にかかわらず停止予定位置となる。そのため，閉塞間隔が狭い箇所や高速運転区間では，4閉塞分あるいはそれ以上の現示をプラグインに与えなければ，本来動作すべきでない箇所で停止パターンによるブレーキが動作することがある。

〔パターン更新地上子の設置例〕地上子のストラクチャは，適切に割り当てられているものとする。

Atsp01 

〔即時停止地上子の設置例〕地上子のストラクチャは，適切に割り当てられているものとする。
　　1000, Track.Beacon 3;0;1;1, Track.Beacon 3;0;2;2, Track.Beacon 3;0;3;9, Track.Beacon 4;0;1;

地上子は，下記の位置に設置する。
1.パターン更新地上子は，信号機から 600m, 180m, 85m, 30m 手前に配置する。
2.信号機から 30m 手前に，即時停止地上子＋パターン更新地上子を配置する（場内・出発は4→絶対停止，閉塞は5→無閉塞許容）。
3.駅手前など，列車が停止信号に接近することの多い箇所では，必要に応じてパターン更新地上子を追加する。主に，信号機から 280m, 130m, 50m 手前であることが多い。
4.列車が停止信号に接近して停車する駅の停止位置付近など，発車時にパターンを更新する必要がある場合には，パターン更新地上子を追加する。
5.上記各号の通り配置する場合に，地上子を配置すべき位置が手前の閉塞区間における信号機30m手前の地上子よりも手前になる場合には，当該地上子は省略する

なお，1〜3，5を図示すると以下のようになる。

Atsp02 



2006年12月 3日 (日) ATS-SW/P2プラグイン 
| 固定リンク | コメント (0) | トラックバック (0) 

 

 
ATS-Sx速度照査の補足




この項目は，以下の機能について整理し，補足するものです。
1.ATS-S分岐器速度超過防止警報（以下，S分岐警報）
2.ATS-SN速度照査（以下，SN速度照査）
3.ATS-ST, SW, SS, SK（以下，ST速度照査）

(1) 構造の違い
1.S分岐警報は，ループコイル（4.5m）または2個の地上子間（10m）の通過時間を地上設備のタイマで検出
2.SN速度照査は，2個の地上子間（10m）の通過時間を地上設備のタイマで検出
3.ST速度照査は，2個の地上子間の通過時間を車上装置のタイマで検出。タイマは電車の場合0.5秒で，照査速度は列車が地上子間隔を調節して設定。（0.5秒以下で通過すると非常制動）

地上設備が複雑になるS分岐警報とSN速度照査は，主に停車場付近において用いられる。また，S分岐警報は，照査速度の設定値が80km/h以下であり，設置箇所は55km/h以下の速度制限箇所に限られる。

(2) 動作の違い
1.S分岐警報は，警報動作（ベルが5秒間鳴動し，確認しなければ非常制動）
2.SN速度照査は，警報動作か即時非常を，地上装置の設定で決める
3.ST速度照査は，即時非常

(3)  ATS-SW/P2プラグインにおける取扱い
1.S分岐警報 地上子種別56
2.SN速度照査 地上子種別 非常制動55 警報56 （実際の設置箇所に合わせて選択または併用）
3.ST速度照査 地上子種別55


いずれも第4引数に照査速度を設定する。BVEでは，地上子間隔は1mごとになるため，直接照査速度を指定して設定を容易にしている。2個の地上子はフリーストラクチャで設置すればよい。SNとSTを同一の取扱としているが，SN車上装置を搭載した車両では，本来ST速度照査は機能しないため，将来の設計見直しで分離される可能性がある。



2006年11月20日 (月) ATS-SW/P2プラグイン 
| 固定リンク | コメント (0) | トラックバック (0) 

 

 
第八　ＡＴＳ機能切換 (2006.11.17改訂)




ATS-Pは，ATS-Sxと併設して使用することができる。また，新設線区や旧ATS-B線区ではATS-Sxを新たに整備することなくATS-Pのみを整備することがある。これらの場合において，ATS-Pが整備されている区間から整備されていない区間へ運転する場合には，ATS機能切換コマンドにより車上装置を適切に動作させる必要がある（※1）。

ATS機能切換を行うためのコマンドは次の通りである。
?地上子の種別：25
?第3引数：0
?第4引数：コマンド内容（0：P→S切換，2：ATS-P機能停止 ）

この地上子は，下記のようにATS-P整備区間の最終となる信号機の奥（分岐器がある場合はその奥）に設置する。なお，パターン更新地上子は，地上子の対応する閉塞にATS-Pが整備されているか否かを問わず，ATS-P区間の運転に支障のないように3〜4閉塞分を設置しなければならない（※1）。

960 ATS-P地上子（信号機30m手前）
980 ATS-Sx直下地上子（信号機20m手前）
990 信号機（Track.SigF および Track.Section 構文）
1000〔JR東日本線区でのATS-P→S切換〕 Track.Beacon 25;0;0;0
　　〔拠点P線区でのATS-P休止〕  Track.Beacon 25;0;0;2

なお，ATS-P車上装置は，パターン更新地上子から情報を受信すると停止予定位置までの停止パターンの演算を開始するので，ATS-Pの整備されていない区間からATS-P整備区間へ運転する場合には，ATS機能切換コマンドは不要である。

※1：ATS-Pは，停止現示でないことが保障されている区間の終端を基準に停止パターンを生成するためである→第六 ATS-P 参照（図）



2006年11月17日 (金) ATS-SW/P2プラグイン 
| 固定リンク | コメント (0) | トラックバック (0) 

 

 
第八の２ 拠点P




ATS-Pは，停車場付近など列車が輻輳するなどの理由で防護の必要性の高い箇所を中心に整備することを前提として設計されており，その他の箇所では既存のATS-Sのみを使用する設置形態がいわゆる拠点Pである。H-ATS（※1），学研都市線，京都・神戸線，宝塚線（※2）などで導入されており，概ね以下のような設置形態となっている。（※3）
1.すべての場内信号機・出発信号機に対してATS-Pを設置（※4）
…場内・出発信号機については，ATS-SW直下地上子が設置されていない箇所でもATS-Pが整備されている（例：神戸線上り尼崎塚本間の第2場内から第4場内および塚本出発）
2.出発信号機の奥（分岐器がある場合は分岐器より奥）にATS-P休止地上子（※4）を設置
…分岐器通過後にATS-P休止地上子を配置した場合，次の信号機までの距離が十分でない場合があり，信号現示の変化に対応できない（停止パターンが残る）ことがある。このような箇所には，当該次の信号機に対してもATS-Pを設置し，その信号機の奥にATS-P休止地上子を配置する（例：京都線上り新大阪東淀川間第0閉塞信号機にATS-P設置）

なお，速度制限PはATS-Pとは別に動作するので，ATS-P休止箇所においても使用できる。（例：宝塚線尼崎塚口間・曲線制限P 70km/h）


※1：H-ATSは，JR化後撤去されたものとみられる。90年代後半の西明石・大阪・京都駅で撮影した写真にATS-P地上子類似のものが写っていない。
※2：宝塚線では，福知山線脱線事故後の運転再開に備えて新三田以南でATS-Pが整備されたが，このうち尼崎宝塚間では，停留所の前後の閉塞信号機にも整備されており，本記事本文の設置形態とは異なるが，宝塚新三田間は上記本文と同じ設置形態らしいので，前記区間の設置形態が特別であると思われる。これについては，今後大和路線王寺加茂間または阪和線日根野和歌山間での設置形態が分かれば，どのような方針で整備されているか判断できそう。
※3：現在運用中の線区はいずれも複線区間であり，単線区間への適用は奈良線での整備を待つことになる
※4：ATS-Pを設置する主信号機とその600m手前の地点との間に別の主信号機がある場合でも，Track.Beacon構文では途中の主信号機の現示は送らない
※5：Track.Beacon 25;0;0;2 (第2引数は適宜ストラクチャを割り当てること)

……なお，以上の記述はATS-SW/P2プラグインの仕様決定のために調査・観察したものであり，どうしても分からない箇所は一応安全側に傾けておこうという発想が入っているので，一部事実の見落とし・誤認があるかもしれない。



2006年11月16日 (木) ATS-SW/P2プラグイン 
| 固定リンク | コメント (0) | トラックバック (0) 

 

 
第七　速度制限Ｐ (2006.12.3 仕様変更)




速度制限Pは，信号機に対するATS-Pとは独立して動作する速度照査機能であり，速度制限（分岐器・下り勾配・曲線・臨時）に対する速度照査と，最高速度（車両ごと）照査がある。地上子から受信した制限速度・制限開始地点・制限区間長の情報から減速パターンを演算し生成し，列車の速度が各種制限のいずれかのパターンを超えた場合には常用最大制動が掛かる。

(1) 速度制限（分岐器・下り勾配・曲線・臨時）

ATS-SW/P2プラグインでは，速度制限設定用Track.Beacon構文の第4引数で制限速度と制限開始地点情報を渡し，制限区間長に代えて制限終了地点に解除用Track.Beacon構文を配置する。地上子種別は以下の通りである。
?分岐器制限 6 （解除 16）
?下り勾配制限 8 （解除 18）
?曲線制限 9 （解除 19）
?臨時制限10（解除 20）

第3引数には 0を入れ，第4引数は以下の数字を左から並べた値に設定する。
?　制限開始地点までの距離[m]（10進整数可変長）
?　制限速度[km/h]（10進整数3桁）

〔設置例〕地上子のストラクチャは，適切に割り当てられているものとする。

　　1000, Track.Beacon 9;0;0;600080 ,; 600m先 080km/h
　　2000, Track.Beacon 19;0;0; ,;解除

　なお，照査速度としての速度制限は，運転上の速度制限に10km/h加えた値である（例：制限60km/hの箇所に対しては70km/hの速度制限Pを設定）。

(2) 最高速度照査 （2006.12.3 更新で設定を車両側に移行して廃止）

最高速度照査は，車両ごとにあらかじめ設定された最高速度を超えた場合に常用最大制動を掛ける。



2006年10月22日 (日) ATS-SW/P2プラグイン 
| 固定リンク | コメント (0) | トラックバック (0) 

 

 
第五　ＡＴＳ−ＳＷ




ATS-SWは，停止信号に対する非常停止機能（直下および誤出発防止），ならびに速度照査機能を有する。

(1) 直下地上子

直下地上子は，場内信号機および出発信号機の20m手前に設置し，停止信号を冒進しようとした場合に非常制動を掛けるものである。
地上子種別は 1であり，第3引数には対応する閉塞（通常，間に複数の閉塞が存在することはないので 1）を指定する。

〔設置例〕地上子のストラクチャは，適切に割り当てられているものとする。

1000, Track.Beacon 1;0;1;

(2) 誤出発防止地上子

誤出発防止地上子は，列車の停止位置と直下地上子の距離が大きいことによって防護が不十分な場合に，直下地上子よりも手前にそれと同等の機能をもつ地上子として設置し，信号冒進による危険を低減するものである。
特に短編成用に設ける場合には，より長編成の列車が入線する場合に短編成用の誤出発防止地上子を動作させないため，タイマによって入線に必要な時間に相当する間地上子を無効としておく機構となっている。
そのため，タイマ起動用の地上子（種別 60）と誤出発防止地上子（種別61）を次のように用いて，機能を実現する。

タイマ起動用地上子：第3引数には0を入れ，第4引数は使わない
誤出発防止地上子：第3引数で指定した閉塞の状態が0（停止）であり，かつタイマ起動用地上子を通過してから第4引数に指定する時間[ミリ秒]経過していた場合に非常制動を掛ける。

〔設置例〕地上子のストラクチャは，適切に割り当てられているものとする。

1000, Track.Beacon 60;0;0; ,;タイマ起動
1200, Track.Beacon 61;0;1;40000 ,;40秒後から非常制動

(2) 速度照査地上子

ATS-SWによる速度照査は，曲線・分岐器・行き止まり等での速度超過を防止するために設置するもので，2つの地上子間の通過時間を判定し，あらかじめ設定された時間以内に通過した（即ち高速の）場合には非常制動を掛けるものである。
通過時間の判定には，地上タイマを用いる方式（ATS-SN方式）と，車上タイマを用いる方式（ATS-ST方式）があるが，ATS-SW/P2プラグインでの取り扱いは同一であり，照査速度を直接指定する。
1つ目の地上子はフリーストラクチャで配置し，2つ目の地上子で以下のように設定して速度照査を行う。
地上子種別は 55。第3引数は使わないので，0を入れておく。地上子通過時の列車速度[km/h]が第4引数で指定した整数値[km/h]以上の場合に非常制動を掛ける。

〔設置例〕地上子のストラクチャは，適切に割り当てられているものとする。

1000, Track.Beacon 55;0;0;80 ,;照査速度80km/hの例



2006年10月20日 (金) ATS-SW/P2プラグイン 
| 固定リンク | コメント (0) | トラックバック (0) 

 

 
第四　ＡＴＳ−Ｓ




ATS-Sロング警報は，信号機が停止現示のときに警報を鳴動し，5秒以内に確認操作がなければ非常制動を掛けるものであり，場内信号機・出発信号機・閉塞信号機のいずれに対しても設置する。
地上子種別は 0。第3引数で指定した閉塞の状態が0（停止）である場合に警報が鳴動する。第4引数は使わない。

〔設置例〕ストラクチャは，適切に割り当てられているものとする。また，ATS-SW直下地上子については後述（第五 ATS-SW）。

Atssw01 

ATS-Sロング地上子は，当該警報箇所における車種別最高速度での警報5秒間の空走距離に，当該警報箇所最高速度からの停止距離を加算した距離のうち，最も多くの距離を要する車種に合わせて設置する。
例えば，減速度4.0km/h/sで最高速度110km/hの列車の上記距離は573mであるが，減速度3.0km/h/sで最高速度100km/hの列車においては602mであるから，地上子は後者に合わせて設置しなければならない。

(2) 分岐器過速度防止警報機能

分岐器過速度防止警報機能は，ループコイルと地上タイマによって2つの地上子間の通過時間を判定し，あらかじめ設定された時間以内に通過した（即ち高速の）場合には警報を鳴動し，5秒以内に確認操作がなければ非常制動を掛けるものである。
ATS-SW/P2プラグインでは，照査速度を直接指定するので，1つ目の地上子はフリーストラクチャで配置し，2つ目の地上子で以下のように設定して速度照査を行う。
地上子種別は 56。第3引数は使わないので，0を入れておく。地上子通過時の列車速度[km/h]が第4引数で指定した整数値[km/h]より高い場合に警報が鳴動する。

〔設置例〕地上子のストラクチャは，適切に割り当てられているものとする。

1000, Track.Beacon 56;0;0;80 ,;照査速度80km/hの例

〔参考〕京都線上り大阪−新大阪間（新大阪副本線分岐に対する警報）

Atssw02 



2006年10月20日 (金) ATS-SW/P2プラグイン 
| 固定リンク | コメント (0) | トラックバック (0) 

 

 
第三　地上子総論 〜 Track.Beacon構文 〜




BVE4では，BVE2でのTrack.Tr構文に代わり，Track.Beacon構文で地上子を設置する。Track.Beacon構文は，特定の保安装置の機能に関係なく，路線の当該位置での情報を保安装置プラグインに渡す構文として抽象化が図られている。また，地上子の形状もストラクチャを指定することによって自由に変えることができる。

Track.Beacon構文の各引数は，次のように設定する。
?Track.Beacon 第1引数; 第2引数; 第3引数; 第4引数

(1) 第1引数……地上子種別

ここで指定する値は，保安装置プラグインによって決まっている。ATS-SW/P2プラグインにおける地上子種別は，各機能の項目で述べる。

(2) 第2引数……ストラクチャ番号

ここで指定する値は，Structure.Beacon(n) で指定したストラクチャ番号 n である。
ただし，このストラクチャは，曲線区間においては円弧曲線を25mごとに切った弦に沿って配置されるため，曲線半径に合わせて曲げた線路ストラクチャ（カーブレール）を用いる場合には，このストラクチャには無表示ストラクチャ（Null.csv等）を割り当てて，フリーストラクチャ(Structure.FreeObj および Track.FreeObj)を用いたほうがよい。

(3) 第3引数……対応する閉塞

ここで指定した閉塞の現示が保安装置プラグインに渡される。
Track.Beacon の存在する閉塞を 0 として，奥の閉塞に向かうほど，1, 2, 3, ……と増加する。

(4) 第4引数……プラグインに送る任意の値

ここで指定した値（整数）は，そのまま保安装置プラグインに渡される。



2006年10月20日 (金) ATS-SW/P2プラグイン 
| 固定リンク | コメント (0) | トラックバック (0) 

 

 
第二　BVE4における信号機と閉塞の考え方（BVE2との比較を中心に）




(1) 概要

BVE2においては，Track.Sig構文によって信号機と閉塞を設置・設定していたが，BVE4ではTrack.Section構文で閉塞を設定し，Track.SigF構文で信号機を設置する。
Track.SigF構文は閉塞の状態を表示する構文であるから，従来の中継信号機（Track.Relay構文）との区別はなくなっている。
さらに，Track.SigF構文では，任意のテクスチャを用いることにより，様々な信号機等の表現が可能である。

(2) 従来の構文との対応関係

まず，BVE4では，信号現示の自由度が向上している（従来は停止・警戒・注意・減速・進行のみ）。特に必要性がない限り，従来通りとするため，次のように設定する。
?Route.Signal(1) 25
?Route.Signal(2) 55
?Route.Signal(3) 75

これらの番号とその前後の番号（0〜4）は，閉塞を作る際に現示番号として指定する。

このようにした場合，BVE2の信号機は，次のようにBVE4の構文に書き換えられる。
?Track.Sig 3;表示名;x;y;種類 → Track.SigF ストラクチャ番号;1;x;y ,Track.Section 0;2;4
?Track.Sig -4;表示名;x;y;種類 → Track.SigF ストラクチャ番号;1;x;y ,Track.Section 0;2;3;4
?Track.Relay x;y → Track.SigF ストラクチャ番号;1;x;y （閉塞を作らない）

上記において，x, y はそれぞれ信号機ストラクチャの設置位置であり，ストラクチャ番号は Signal(n).Load で指定した n の番号に対応する。

(3) 閉塞の作り方

Track.Section の引数として，当該閉塞に先行列車が存在する場合の現示番号，1つ先の閉塞に先行列車が存在する場合の現示番号，2つ先の閉塞に先行列車が存在する場合の現示番号，……，の順に現示番号を指定する。
現示の変化は，最後に指定した番号で止まるので，Track.Section 0;2 とすれば，対応する信号機には停止と注意の現示しか出ないことになる。
また，Track.Section 0;2;2;4 とすれば，注意現示が2つ連続する信号機を再現できる。
なお，通常の用途では使わないが，Track.SigF 0;1;2;4;1;3;4 のような設定をすることも可能である。

(4) 信号機の作り方

信号機のストラクチャは，「Signal(n).Load ストラクチャのパス」で指定する。このストラクチャについて，現示番号に対応したテクスチャが表示される。
Track.SigF構文では，対応する閉塞を第2引数で指定する必要がある。指定する数字は，信号機が存在する閉塞の状態を現示する場合には「0」，1つ奥の閉塞であれば「1」となる。
従って，同一のキロ程に Track.Section と Track.SigF を置く場合には， Track.Section を先に記述すれば Track.SigF の設置位置は閉塞区間内となるが， Track.SigF を先に記述すれば，その設置位置は閉塞の外方となる。

（例）以下の2つの記述方法では，Track.SigFは同じ閉塞の状態を現示する。
?1000, Track.Section 0;2;3, Track.SigF n;0;x;y
?1000, Track.SigF n;1;x;y, Track.Section 0;2;3



2006年10月19日 (木) ATS-SW/P2プラグイン 
| 固定リンク | コメント (0) | トラックバック (0) 

 

 
第一　定義




※ATS-SW/P2プラグインの路線への適用方法の説明
※今後書き足して，最終的には文書化する予定
※記載済み箇所についても随時改訂する

ATS-SW/P2プラグインの機能は，ATS-SWに関する機能，ATS-Pに関する機能，その他車両機能に大別される。
このうち，ATS-SWおよびATS-Pについては，便宜的に下記のように細分する。
?ATS-S：停止信号に対する警報機能および分岐器過速度防止警報機能を指す。
?ATS-SW：停止信号に対する非常停止機能（直下および誤出発防止），ならびに車上タイマによる速度照査機能を指す。
?ATS-Sx： 上記ATS-S，ATS-SWに加え，-SN，-ST等を含む。
?ATS-P：以下では，信号機に対するATS-P停止パターンを指すものとする。
?速度制限P：信号機とは独立して動作する，ATS-Pによる速度照査機能を指す。
?信号機：Track.SigF構文によって設定される信号機等を指す。
?閉塞：主信号機の種類（場内，出発，閉塞，誘導，入換）を問わず，Track.Section構文で設定される区間を指す。
?路線：BVEでの表現としてcsvファイルに記述された運転線路を指し，キロ程の起点は常に 0 である。
?手前：路線において，キロ程が0に近い方向を指す。
?奥：路線において，キロ程が0から遠い方向を指す。
